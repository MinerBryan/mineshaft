<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/main.css">
</head>

<header>
       <a href="index.html">The Mineshaft</a>
</header>

<nav>
    <ul>
      <a href="index.html">Home</a>
      <a href="roulette.html" class="active">Roulette</a>
      <a href="wordle.html">Wordle</a>
      <a href="about.html">About</a>
    </ul>
</nav>

<body onload="loadWheel()">
    <link rel="stylesheet" href="css/roulette.css">
    <br><br>
    <div>
        <center>
            <div class="wheelContainer">
                <div class="line"></div>
                <div id="fillWheel" class="wheel"></div>
            </div>
        </center>
    </div>
    <br><br><br><br>
    <center>
        <div>
            <button id="startButton" onclick="play()">Roll</button>
        </div>
    </center>
    <br>
    <div>
        <center>
            <input id="inputName" placeholder="Name">
                
            <button id="addButton" onclick="addName()">Add</button>
            <br>
            <br>
            <div>
                <ul id="names" class="contendor-list"></ul>
            </div>
        </center>
    </div>
    <br><br>
     <div>
        <center>
            <button id="clearButton" onclick="clearAll(-1)">Clear Winner History</button>
        </center>
    </div>
    <br>
    <center>
        <div id="winners" class="winners"></div>
    </center>
</body>

<script>
    var boxAmount = 80;
    var order = [];
    var playerAmount = 0;
    function loadWheel(){
        let wheel = document.getElementById("fillWheel");
        wheel.innerHTML = "";
        let tempBets = [
			["Rock", "grey","#616161"], 
			["Paper", "white","#e5e5e5"],
			["Scissor","#525252","#383838"]
		];
		for(var i = 0; i < boxAmount; i++){
			var randomPlayer = rand(0, tempBets.length)
			let node = document.createElement("div")
			var h3 = document.createElement("h3");
			let color = tempBets[randomPlayer][1];
			h3.innerHTML = tempBets[randomPlayer][0];
			h3.style.backgroundColor = color;
			if (color == "#525252" || color == "#2525252" || color == "#5e5e5e" || color == "#000000" || color == "black"){
		        h3.style.color = "#ffffff";
	        }
	        h3.style.borderStyle = "solid";
	        h3.style.borderWidth = "4px";
			h3.style.borderColor = tempBets[randomPlayer][2];
			node.appendChild(h3);
			wheel.appendChild(node);
		}
		for(var j = 0; j < tempBets.length; j++){
			let name = tempBets[j][0];
			let color = tempBets[j][1];
			let node = document.createElement("LI");
			let textnode = document.createTextNode(name);
			
			node.style.backgroundColor = color;
			if (color == "#525252" || color == "#2525252" || color == "#5e5e5e" || color == "#000000" || color == "black"){
		        node.style.color = "#ffffff";
	        }
			
			node.style.borderStyle = "solid";
			node.style.borderWidth = "4px";
			node.style.borderColor = tempBets[j][2];
			
			node.className = "playerName";
			node.id = "n" + j;
			(function(value){node.addEventListener("click", function() {removeName(value);}, false);})(j);
			node.appendChild(textnode);
			document.getElementById("names").appendChild(node);
			
			bets.push([name, color, tempBets[j][2]]);

			playerAmount++;
		}
	}
	function rand (min, max) {
        	return Math.floor(Math.random() * (max - min)) + min;
	}
	var colors= ["grey","white","#bababa","#6f6f6f","#828282","#949494","#a7a7a7","#5e5e5e","#c7c7c7","#e3e3e3"];
	var borders= ["#616161", "#e5e5e5", "#a6a6a6", "#595959","#6f6f6f", "#737373", "#8f8f8f","#404040","#b5b5b5","#d5d5d5"]
	var width = 80;
	var bets = [];
	var playing = false;
	
	// This is the Play Function, where everything is handled
	function play () {
	    /*if (playing == false){*/
		    /*var audio = new Audio('spin.mp3');
		    audio.volume = 0.5;
		    audio.play();*/
		    
		    var offset = rand(0, boxAmount*160-180)+180;
		    document.getElementById("fillWheel").style.left = -(offset-180) + "px";
		    
		    
		    // Chooses the Random answer, and spins the wheel
		    let chosenPlayer = document.createElement("div");
		    let ranNum = parseInt(offset/160);
		    let backColor = bets[order[ranNum]][1];
		    let border = bets[order[ranNum]][2];
		    chosenPlayer.style.backgroundColor = backColor;
		    chosenPlayer.style.borderColor = border;
		    if (backColor == "#525252" || backColor == "#2525252" || backColor == "#5e5e5e" || backColor == "#000000" || backColor == "black"){
		        chosenPlayer.style.color = "#ffffff";
	        }
		    chosenPlayer.innerHTML = bets[order[ranNum]][0];
		    setTimeout(function(){
			    document.getElementById("winners").appendChild(chosenPlayer);
			    document.getElementById("fillWheel").style.transitionDuration = "2s";
			    document.getElementById("fillWheel").style.right = "0px";
			    setTimeout(function(){
			    	document.getElementById("fillWheel").style.transitionDuration = "5s";
			    }, 50)
		    }, 5500)
		
	}
	
	// Removes from the list of elements
	function removeName(playerToRemove){
		bets[playerToRemove] = 0;
		document.getElementById("n"+playerToRemove).remove();
		playerAmount--;
		refreshWheel();
	}
	
	// Clears all winning elements
	function clearAll(winnerToClear){
		if(winnerToClear == -1){
			document.getElementById("winners").innerHTML = "";
			return true;
		} else {
			document.getElementById("w"+winnerToClear).innerHTML = "";
		}
	}
	
	// adds element to contendor list
	function addName() {
		var node = document.createElement("LI");
		var name = document.getElementById("inputName").value
		document.getElementById("inputName").value = ""
		if(name != ""){
			var textnode = document.createTextNode(name);
			let randNum = rand(0,colors.length-1);
			let color = colors[randNum];
			let borderColor = borders[randNum];
			node.style.backgroundColor = color;
			if (color  == "#525252" || color == "#2525252" || color == "#5e5e5e" || color == "#000000" || color == "black"){
		        node.style.color = "#ffffff";
	        }
	        node.style.borderStyle = "solid";
	        node.style.borderWidth = "4px";
	        node.style.borderColor = borderColor;
			node.className = "playerName";
			node.id = "n" + bets.length;
			(function(value){node.addEventListener("click", function() {removeName(value);}, false);})(bets.length);

			node.appendChild(textnode);
			document.getElementById("names").appendChild(node);
			bets.push([name, color, borderColor]);

			playerAmount++;
			refreshWheel();
		}
	}
	function refreshWheel(){
		let wheel = document.getElementById("fillWheel");
		wheel.innerHTML = "";
		order = [];

		if(playerAmount <= 0){
			return 0;
		}

		for(var i = 0; i < boxAmount; i++){
			var randomPlayer = rand(0, bets.length);
			while(bets[randomPlayer] == 0){
				randomPlayer = rand(0, bets.length);
			}
			order.push(randomPlayer);
			var node = document.createElement("div");
			var h3 = document.createElement("h3");
			let color = bets[randomPlayer][1];
			h3.innerHTML = bets[randomPlayer][0];
			node.style.backgroundColor = color;
			if (color  == "#525252" || color == "#2525252" || color == "#5e5e5e" || color == "#000000" || color == "black"){
		        node.style.color = "#ffffff";
	        }
	        node.style.borderColor = bets[randomPlayer][2];
	        node.style.borderStyle = "solid";
	        node.style.borderWidth = "4px";
	        node.appendChild(h3);
			wheel.appendChild(node);
		}
	}

	document.getElementById("inputName").addEventListener("keyup", function(event){
		if(event.keyCode == 13){
			document.getElementById("addButton").click();
		}
	})
	document.getElementById("max").addEventListener("keyup", function(event){
		if(event.keyCode == 13){
			addTimer();
		}
	})
    
</script>
        
    
</script>
